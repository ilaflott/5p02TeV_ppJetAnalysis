
//these JEC from marta's script
//// https://github.com/mverwe/JetRecoValidation/blob/master/tools/getJEC_cfg.py
//// /home/ilaflott/5p02TeV_ppJetAnalysis/CMSSW_7_5_8/src/getJECs/getJECs/JECCorrParamCollection_v7_ak4PF_75X_dataRun2_v13

std::string L2RelL3AbsJEC_str="[0]+[1]/(1+exp(min(88,[2]*(x+[3]))))+[4]*x^[5]+[6]*log(x)+[7]*log(x)^2";
//const float L2RelL3AbsJEC_ptlo= 3., L2RelL3AbsJEC_pthi=   25100.;

const float  L2RelL3AbsJEC_ptlo[]={
3.,
3.,
3.,
3.,
3.,
3.,
3.,
3.,
3.,
3.,
3.,
3.,
3.,
3.,
3.,
3.,
3.,
3.,
3.,
3.,
3.,
3.,
3.,
3.,
3.,
3.,
3.,
3.,
3.,
3.,
3.,
3.,
3.,
3.,
3.,
3.,
3.,
3.,
3.,
3.,
3.,
3.,
3.,
3.,
3.,
3.,
3.,
3.,
3.,
3.,
3.,
3.,
3.,
3.,
3.,
3.,
3.,
3.,
3.,
3.,
3.,
3.,
3.,
3.,
3.,
3.,
3.,
3.,
3.,
3.,
3.,
3.,
3.,
3.,
3.,
3.,
3.,
3.,
3.,
3.,
3.,
3.
};

const float  L2RelL3AbsJEC_pthi[]={
 6.45969,
 9.01521,
  11.526,
 14.7462,
 18.7709,
 23.9173,
 30.4731,
 38.6762,
 49.0102,
 61.9291,
 77.9766,
 97.7525,
 117.118,
 142.129,
 175.404,
 211.553,
 252.856,
 291.918,
 328.479,
 362.448,
 393.908,
 423.966,
 453.984,
 484.219,
  514.41,
 544.288,
 573.583,
 602.029,
 629.376,
 655.387,
 678.626,
 701.446,
 723.401,
 742.188,
 758.825,
  773.22,
 785.306,
 795.028,
 802.349,
 807.243,
 809.693,
809.693	,
807.243	,
802.349	,
795.028	,
785.306	,
 773.22	,
758.825	,
742.188	,
723.401	,
701.446	,
678.626	,
655.387	,
629.376	,
602.029	,
573.583	,
544.288	,
 514.41	,
484.219	,
453.984	,
423.966	,
393.908	,
362.448	,
328.479	,
291.918	,
252.856	,
211.553	,
175.404	,
142.129	,
117.118	,
97.7525	,
77.9766	,
61.9291	,
49.0102	,
38.6762	,
30.4731	,
23.9173	,
18.7709	,
14.7462	,
 11.526	,
9.01521 ,
6.45969
};


const float L2RelL3AbsJEC_etabins[]={
-5.191 ,
-4.889 ,
-4.716 ,
-4.538 ,
-4.363 ,
-4.191 ,
-4.013 ,
-3.839 ,
-3.664 ,
-3.489 ,
-3.314 ,
-3.139 ,
-2.964 ,
-2.853 ,
-2.65  ,
-2.5   ,
-2.322 ,
-2.172 ,
-2.043 ,
-1.93  ,
-1.83  ,
-1.74  ,
-1.653 ,
-1.566 ,
-1.479 ,
-1.392 ,
-1.305 ,
-1.218 ,
-1.131 ,
-1.044 ,
-0.957 ,
-0.879 ,
-0.783 ,
-0.696 ,
-0.609 ,
-0.522 ,
-0.435 ,
-0.348 ,
-0.261 ,
-0.174 ,
-0.087 ,
0      ,
0.087  ,
0.174  ,
0.261  ,
0.348  ,
0.435  ,
0.522  ,
0.609  ,
0.696  ,
0.783  ,
0.879  ,
0.957  ,
1.044  ,
1.131  ,
1.218  ,
1.305  ,
1.392  ,
1.479  ,
1.566  ,
1.653  ,
1.74   ,
1.83   ,
1.93   ,
2.043  ,
2.172  ,
2.322  ,
2.5    ,
2.65   ,
2.853  ,
2.964  ,
3.139  ,
3.314  ,
3.489  ,
3.664  ,
3.839  ,
4.013  ,
4.191  ,
4.363  ,
4.538  ,
4.716  ,
4.889  ,
5.191  
};
const int n_L2RelL3AbsJEC_etabins=sizeof(L2RelL3AbsJEC_etabins)/sizeof(float)-1;

const float L2RelL3Abs_par0_arr[]=  {
  0.66086   ,
  -0.115703 ,
  -2.03657  ,
  -0.516218 ,
  -4.60907  ,
  -0.498505 ,
  -1.69476  ,
  -7.76132  ,
  -0.019104 ,
  -10.1483  ,
  2.12741   ,
  -49.7235  ,
  -0.767174 ,
  0.047272  ,
  -0.917485 ,
  -0.009723 ,
  -0.081026 ,
  -0.157045 ,
  0.433028  ,
  -0.131952 ,
  0.184722  ,
  0.01425   ,
  0.065307  ,
  -0.272731 ,
  -0.046041 ,
  -0.086674 ,
  -0.234124 ,
  -0.045562 ,
  -0.117998 ,
  -0.167472 ,
  -0.211946 ,
  -0.205581 ,
  -0.428527 ,
  -0.193575 ,
  -0.338691 ,
  -0.333368 ,
  -0.138848 ,
  -0.246544 ,
  -1.37452  ,
  -0.183831 ,
  -0.321176 ,
  -0.201394 ,
  -0.23191  ,
  -0.35921  ,
  -0.245948 ,
  -0.217191 ,
  -0.250279 ,
  -0.312944 ,
  -0.344088 ,
  -0.318448 ,
  -0.197155 ,
  -0.284903 ,
  -0.979662 ,
  -0.148904 ,
  -0.129086 ,
  -0.116752 ,
  -1.22831  ,
  -0.000309 ,
  0.122148  ,
  -0.020219 ,
  -0.030674 ,
  88.4072   ,
  -0.132751 ,
  -0.138073 ,
  -0.158178 ,
  -0.006712 ,
  0.1072    ,
  0.211273  ,
  -0.42896  ,
  0.126152  ,
  0.144904  ,
  0.140649  ,
  1.57836   ,
  -7.48922  ,
  -8.11661  ,
  0.786108  ,
  -9.53614  ,
  -0.783553 ,
  -0.506778 ,
  2.44831   ,
  0.113577  ,
  -0.42758  ,
};
const float L2RelL3Abs_par1_arr[]=  {
  2.05825,
   1.3781,
  43.7702,
  1.66965,
  10.8796,
  1.23103,
  5.64729,
  14.9103,
  1.60404,
  101.961,
 -13.3728,
  42.3456,
  1.60615,
   7.0456,
  112.396,
  2.49953,
 0.585269,
  3.48193,
 -1.67212,
  1.34282,
 0.318283,
  1.44347,
  1.36866,
  2.24183,
 0.474879,
  36.2963,
 0.437778,
 0.874607,
  32.9366,
  3.06641,
   3.1448,
  3.95714,
  1.98477,
  3.12481,
  1.87135,
 -0.56146,
  34.2615,
  9.79041,
  55.8879,
  1.49249,
  1.72707,
  1.35277,
  2.33755,
  2.99068,
  3.57886,
  2.16899,
  5.95457,
  1.61325,
  1.17494,
  4.08806,
  5.79426,
  4.15818,
  7.08858,
  5.44501,
 0.374486,
  1.88262,
  7.24188,
 0.563725,
 0.509973,
  1.10946,
  1.37029,
 -2.57302,
 -0.16406,
 0.384645,
  1.91854,
  1.00946,
 0.751818,
  3.85595,
 0.574371,
  5.04528,
  1.66976,
  1.81396,
  4.72916,
  25.8638,
  21.9512,
  2.63139,
-0.320431,
  1.44193,
  2.93681,
  11.7931,
  2.05879,
-0.367549
};
const float L2RelL3Abs_par2_arr[]=  {
  0.823626,
  0.312415,
  0.159916,
  0.213004,
  0.192867,
  0.165147,
  0.096562,
 -0.130508,
   0.06009,
  0.004462,
  -0.02401,
 -0.055251,
  0.525182,
  0.240089,
   1.12454,
  0.818693,
  0.927602,
   0.61626,
   1.68346,
  0.841333,
   1.50954,
  0.820897,
   1.19143,
  0.619515,
  0.660939,
  0.599754,
  0.660484,
  0.771231,
  0.615486,
  0.721021,
  0.674636,
  0.696098,
  0.243757,
  0.688722,
  0.574111,
   1.12899,
  0.401433,
   0.58458,
   0.55012,
   0.76986,
  0.915766,
  0.828303,
  0.842468,
  0.506223,
  0.681907,
  0.734453,
  0.562569,
  0.699049,
   0.49539,
  0.707608,
  0.647926,
  0.657282,
  0.072402,
  0.601862,
  0.849389,
  0.809684,
  0.103841,
   1.17157,
   2.85103,
  0.676468,
  0.576478,
    1.2433,
   1.72519,
   1.08991,
  0.678113,
   1.50401,
   1.49117,
  0.684333,
  0.791037,
  0.744127,
  0.010791,
  0.000418,
   0.02376,
  0.067511,
  0.049074,
 -0.221748,
  -4.33863,
  0.172864,
   0.22648,
  0.679915,
  0.624267,
  0.977485
};
const float L2RelL3Abs_par3_arr[]=  {
  -1.35122,
  -4.02029,
   16.2462,
  -2.96124,
   6.26394,
  -13.7652,
  -19.2129,
  -6.23303,
  -39.7361,
   373.661,
   988.585,
   55.5625,
  -3.64106,
   10.5288,
    2.1274,
  -2.29748,
  -5.11073,
  -1.68869,
  -6.47353,
  -3.20911,
  -2.47087,
  -1.95889,
  -3.51512,
  -1.75442,
  -2.46063,
   3.75081,
  -3.90881,
  -2.34129,
   2.57904,
  -2.21453,
  -2.61377,
  -2.02958,
   3.94473,
  -2.16623,
  -1.88546,
  -1.68592,
   8.02366,
  0.189753,
    4.4876,
  -3.39912,
 -0.364535,
  -3.69766,
   -3.2282,
  -1.09326,
  -2.36808,
  -2.43843,
  -0.95841,
  -2.21051,
  -2.27958,
  -1.31421,
 -0.783344,
  -1.62589,
   38.9064,
  -0.45435,
  -6.32262,
  -2.79303,
   38.2783,
  -4.16081,
  -2.98035,
   -4.3233,
  -2.35505,
  -3.65606,
  -3.67885,
  -5.50837,
  -2.25397,
   -3.1571,
  -3.28009,
 -0.066352,
  -7.15452,
  0.168628,
  -44.7698,
  -661.294,
  -17.0519,
   -1.2085,
  -8.80437,
  -4.30643,
   276.204,
  -9.29798,
   3.68215,
   3.29965,
  -0.36497,
  -2.68192
};
const float L2RelL3Abs_par4_arr[]=  {
  2.17971,
  1.54799,
  1.30175,
  1.20344,
  1.64792,
  1.31749,
  1.77437,
  0.17588,
  1.56038,
 -3.68097,
  11.9977,
  13.4635,
  1.54728,
  1.61422,
  3.94208,
  1.58918,
  1.56018,
  1.53385,
  1.71422,
  1.54493,
  1.27967,
  1.58338,
  1.29503,
  1.68813,
  1.56345,
  1.54834,
   1.7162,
  1.55904,
  1.53596,
  1.52234,
   1.5101,
  1.50995,
  1.70904,
  1.51225,
  1.71101,
  1.71487,
  1.52657,
  1.49955,
  2.99704,
   1.5162,
  1.76215,
  1.51195,
  1.50491,
  1.64139,
  1.50033,
  1.50764,
  1.49951,
  1.67975,
  1.69944,
  1.68198,
  1.51114,
  1.65681,
   1.9007,
  1.52934,
  1.53749,
  1.54513,
  2.78802,
  1.57608,
  1.15212,
  1.12612,
  1.57009,
 -85.6815,
  1.67314,
  1.54195,
  1.53344,
  1.58388,
  1.62788,
  1.66359,
 0.868364,
  1.66637,
   1.6245,
  1.63873,
 -1.20679,
-0.000419,
 0.556431,
  2.23306,
 0.003059,
  1.25461,
  1.47815,
   3.4142,
  1.70706,
  1.27805
};
const float L2RelL3Abs_par5_arr[]=  {
  0.086711,
  0.084882,
  0.491975,
  0.209971,
  0.295483,
  0.145784,
 -0.642644,
   1.18138,
 -0.075683,
  -1.03426,
  0.294123,
 -0.313336,
 -0.087113,
  0.065044,
 -0.556467,
  0.075738,
  0.081624,
   0.08618,
  0.040533,
  0.084645,
  0.162577,
  0.074698,
  0.180778,
  0.021474,
   0.07914,
  0.036394,
  0.014739,
  0.078353,
    0.0199,
  0.083321,
  0.085277,
  0.084371,
  0.005213,
  0.083433,
  0.017081,
  0.011464,
  -0.00134,
  0.083506,
 -0.269971,
  0.083008,
  0.003356,
  0.083903,
  0.085216,
  0.026236,
  0.085048,
  0.083672,
  0.077264,
  0.019285,
  0.015833,
  0.018434,
  0.082296,
  0.026763,
 -0.090688,
  0.081349,
  0.082529,
  0.082209,
 -0.241773,
   0.07721,
  0.208038,
  0.228964,
  0.078261,
  0.095855,
  0.025237,
  0.085005,
  0.086017,
  0.074876,
  0.063959,
  0.052144,
  0.390137,
  0.092385,
 -0.017891,
   0.01645,
  -0.36736,
   2.31309,
   -1.0561,
 -0.340607,
   2.23493,
  0.197587,
  0.445512,
 -0.482176,
  0.045487,
   0.05057
};
const float L2RelL3Abs_par6_arr[]=  {
    -0.2598, 
   -0.24576, 
    1.25616, 
   0.765439, 
    3.09382, 
  -0.075141, 
   -2.05621, 
    5.98369, 
  -0.730547, 
   -2.73788, 
   -1.66275, 
    2.05334, 
   0.624651, 
  -0.273326, 
   0.621454, 
  -0.275615, 
  -0.247783, 
  -0.212309, 
  -0.510924, 
  -0.217205, 
  -0.296708, 
  -0.300423, 
  -0.266248, 
  -0.146383, 
  -0.273471, 
  -0.182915, 
  -0.166153, 
  -0.279988, 
  -0.161221, 
   -0.22902, 
  -0.209496, 
  -0.215934, 
  -0.096715, 
  -0.223294, 
  -0.150637, 
  -0.146589, 
  -0.127362, 
  -0.193556, 
    0.45326, 
  -0.225667, 
  -0.158008, 
  -0.217271, 
  -0.201728, 
  -0.129013, 
  -0.196105, 
  -0.209438, 
  -0.183066, 
  -0.153746, 
  -0.142976, 
  -0.150086, 
  -0.219302, 
   -0.16515, 
   0.226373, 
  -0.231249, 
  -0.236803, 
  -0.234038, 
   0.416643, 
  -0.297489, 
  -0.215675, 
  -0.138195, 
  -0.280365, 
    7.18098, 
  -0.199631, 
  -0.217018, 
  -0.211498, 
   -0.28812, 
  -0.343086, 
  -0.406754, 
   0.447692, 
  -0.248929, 
   -0.56741, 
  -0.430861, 
   -1.32425, 
   -3.91452, 
   -3.32871, 
   -1.11749, 
    11.6148, 
   0.282091, 
   0.691389, 
   -1.38259, 
  -0.319975, 
  -0.317016
};
const float L2RelL3Abs_par7_arr[]=  {
   -0.251342,
    0.003778,
   -0.685325,
   -0.317315,
   -0.832987,
   -0.027247,
    0.727678,
    -3.03333,
    0.172672,
    0.595811,
    -1.21276,
   -0.184477,
   -0.093081,
    0.005793,
   -0.054016,
    0.006307,
    0.002726,
   -0.001673,
    0.044362,
   -0.001808,
   -0.020129,
    0.010711,
   -0.034071,
    0.009202,
    0.008205,
    0.009963,
    0.012474,
    0.009076,
    0.012271,
    0.003043,
     0.00072,
    0.001912,
    0.008665,
    0.002723,
    0.011326,
    0.012231,
    0.012582,
    -8.3e-05,
   -0.024187,
    0.002986,
    0.014901,
    0.00181 ,
   -0.000174,
    0.007582,
   -0.000476,
    0.001239,
    0.000705,
    0.011411,
     0.01091,
    0.011171,
    0.002926,
    0.011326,
    -0.01113,
    0.003784,
      0.0034,
    0.002409,
   -0.022953,
    0.011501,
   -0.048268,
    -0.06983,
    0.008101,
    0.606985,
    0.013157,
   -0.001765,
   -0.002357,
     0.00907,
    0.017948,
    0.030089,
   -0.272893,
   -0.014769,
    0.095184,
    0.024565,
    0.260855,
      1.7608,
     1.31047,
    0.107669,
    -2.91478,
   -0.129483,
   -0.667301,
    0.194938,
   -0.078353,
    0.024286
};






std::string L2L3ResJEC_str="(1./[2])*([3]*([4]+[5]*TMath::Log(max([0],min([1],x))))*1./([6]+[7]*100./3.*(TMath::Max(0.,1.03091-0.051154*pow(x,-0.154227))-TMath::Max(0.,1.03091-0.051154*TMath::Power(208.,-0.154227)))+[8]*((-2.36997+0.413917*TMath::Log(x))/x-(-2.36997+0.413917*TMath::Log(208))/208)))";
const float L2L3ResJEC_ptlo= 10., L2L3ResJEC_pthi=   6500.;

const float L2L3ResJEC_etabins[]={
-5.191,
-3.139,
-2.964,
-2.853,
-2.65 ,
-2.5  ,
-2.322,
-2.172,
-1.93 ,
-1.653,
-1.305,
-1.044,
-0.783,
-0.522,
-0.261,
0     ,
0.261 ,
0.522 ,
0.783 ,
1.044 ,
1.305 ,
1.653 ,
1.93  ,
2.172 ,
2.322 ,
2.5   ,
2.65  ,
2.853 ,
2.964 ,
3.139 ,
5.191 
};
const int n_L2L3ResJEC_etabins=sizeof(L2L3ResJEC_etabins)/sizeof(float)-1;


const float L2L3Res_par0_arr[]={
  55.,
  55.,
  55.,
  55.,
  55.,
  55.,
  55.,
  55.,
  55.,
  55.,
  55.,
  55.,
  55.,
  55.,
  55.,
  55.,
  55.,
  55.,
  55.,
  55.,
  55.,
  55.,
  55.,
  55.,
  55.,
  55.,
  55.,
  55.,
  55.,
 55.
};
const float L2L3Res_par1_arr[]={
  510.,
  510.,
  560.,
  710.,
  790.,
  850.,
  920.,
  1260.,
  1380.,
  1590.,
  1970.,
  1810.,
  1950.,
  2060.,
  2160.,
  2160.,
  2060.,
  1950.,
  1810.,
  1970.,
  1590.,
  1380.,
  1260.,
  920.,
  850.,
  790.,
  710.,
  560.,
  510.,
   510.
};
const float L2L3Res_par2_arr[]={
  0.997211,
  0.997211,
  0.997211,
  0.997211,
  0.997211,
  0.997211,
  0.997211,
  0.997211,
  0.997211,
  0.997211,
  0.998365,
  0.998365,
  0.998365,
  0.998365,
  0.998365,
  0.998365,
  0.998365,
  0.998365,
  0.998365,
  0.998365,
  0.997211,
  0.997211,
  0.997211,
  0.997211,
  0.997211,
  0.997211,
  0.997211,
  0.997211,
  0.997211,
  0.997211
};
const float L2L3Res_par3_arr[]={
  1.00102,
  0.997701,
  0.995561,
  1.0059,
  0.997526,
  1.00035,
  0.999413,
  0.999528,
  0.997976,
  0.998052,
  0.999222,
  0.997827,
  0.998647,
  0.997566,
  0.998481,
  0.998481,
  0.997566,
  0.998647,
  0.997827,
  0.999222,
  0.998052,
  0.997976,
  0.999528,
  0.999413,
  1.00035,
  0.997526,
  1.0059,
  0.995561,
  0.997701,
    1.00102
};
const float L2L3Res_par4_arr[]={
  1.20747,
  1.16704,
  1.09925,
  1.06602,
  1.01631,
  0.990704,
  0.982296,
  1.0031,
  0.997832,
  0.998762,
  1.00718,
  1.00531,
  1.00429,
  0.995925,
  0.987379,
  0.987379,
  0.995925,
  1.00429,
  1.00531,
  1.00718,
  0.998762,
  0.997832,
  1.0031,
  0.982296,
  0.990704,
  1.01631,
  1.06602,
  1.09925,
  1.16704,
    1.20747
};
const float L2L3Res_par5_arr[]={
  -0.021848,
  -0.015173,
  0.003004,
  0.002062,
  0.002836,
  0.007082,
  0.008329,
  0.001087,
  -0.0003,
  -0.002097,
  0.,
  0.,
  0.,
  0.,
  0.,
  0.,
  0.,
  0.,
  0.,
  0.,
  -0.002097,
  -0.0003,
  0.001087,
  0.008329,
  0.007082,
  0.002836,
  0.002062,
  0.003004,
  -0.015173,
   -0.021848
};
const float L2L3Res_par6_arr[]={
  0.9872,
  0.9872,
  0.9872,
  0.9872,
  0.9872,
  0.9872,
  0.9872,
  0.9872,
  0.9872,
  0.9872,
  0.9872,
  0.9872,
  0.9872,
  0.9872,
  0.9872,
  0.9872,
  0.9872,
  0.9872,
  0.9872,
  0.9872,
  0.9872,
  0.9872,
  0.9872,
  0.9872,
  0.9872,
  0.9872,
  0.9872,
  0.9872,
  0.9872,
 0.9872
};
const float L2L3Res_par7_arr[]={
  0.092,
  0.092,
  0.092,
  0.092,
  0.092,
  0.092,
  0.092,
  0.092,
  0.092,
  0.092,
  0.092,
  0.092,
  0.092,
  0.092,
  0.092,
  0.092,
  0.092,
  0.092,
  0.092,
  0.092,
  0.092,
  0.092,
  0.092,
  0.092,
  0.092,
  0.092,
  0.092,
  0.092,
  0.092,
  0.092
};
const float L2L3Res_par8_arr[]={
  0.,
  0.,
  0.,
  0.,
  0.,
  0.,
  0.,
  0.,
  0.,
  0.,
  0.,
  0.,
  0.,
  0.,
  0.,
  0.,
  0.,
  0.,
  0.,
  0.,
  0.,
  0.,
  0.,
  0.,
  0.,
  0.,
  0.,
  0.,
  0.,
  0.
};
